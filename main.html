<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
    <title>测试Pie饼状图型</title>
     <script src="//cdn.bootcss.com/Chart.js/2.7.1/Chart.bundle.js"></script>
    <script src="https://cdn.bootcss.com/vue/2.2.2/vue.min.js"></script>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="static/semantic.js"></script>
    <link href="static/semantic.css" rel="stylesheet">
     <style>

    </style>
</head>
<body>
<div id="vuetest" class="ui container">
<table class="ui celled table">
    <thead>
    <tr>
        <th v-for="title in table1_head">{{title}}</th>

    </tr>
    </thead>
    <tbody>
    <tr v-for="(each_data, index) in staff_data">
        <td v-for="title in table1_head">{{each_data[title]}}</td>
    </tr>
    </tbody>
</table>
<table class="ui celled table">
    <thead>
    <tr>
        <th v-for="title in table2_head">{{title}}</th>
        <th> 雷达图 </th>
    </tr>
    </thead>
    <tbody>
    <tr v-for="(each_data, index) in staff_data">

        <td v-for="title in table2_head">{{each_data[title]}}</td>
        <td><button class="ui yellow button" @click="showRadar(each_data)">雷达图</button></td>


    </tr>
    </tbody>
</table>
<!-- 展示canvas -->
 <div>
    <canvas id="myChart"></canvas>
 </div>
    <!--<div style="width: 500px;">-->
    <!--<canvas id="myChart" style="width:400px; height:800px;" ></canvas>-->
 <!--</div>-->
</div>

<!--引入 chartjs-->



<script>

    var vm = new Vue({
        el: '#vuetest',
        data: {
            head: ["团队建设","员工培养","协调安排","合理授权"],
            team:{
                "name":"部门平均分",
                "score":[25, 25, 25, 25]
            },
            person:{
                "name":"laobzhang",
                "score":[18, 19, 19, 23]
            },
            staff_data : [],
            table1_head : [],
            table2_head : []
        },
        methods: {
            showRadar: function (user_data) {
                vm.person.score = user_data.person_score;
                vm.person.name = user_data.姓名

                // 设置参数
                var data = {
                    labels: vm.head,
                    datasets: [
                        {
                            label: vm.person.name,
//            线图填充颜色
                            backgroundColor: "rgba(75,192,192,0.4)",
//            填充边框颜色
                            borderColor: "rgba(75,192,192,1)",
//            顶点颜色
                            pointBackgroundColor: "rgba(75,192,192,1)",
//            顶点圈颜色
                            pointBorderColor: "rgba(75,192,192,1)",
                            pointHoverBackgroundColor: "rgba(75,192,192,1)",
                            pointHoverBorderColor: "rgba(75,192,192,1)",
                            pointColor: "rgba(66,37,186,1)",
                            pointStrokeColor: "#fff",
                            pointHighlightFill: "#fff",
                            pointHighlightStroke: "rgba(220,220,220,1)",
                            data: vm.person.score
                        },
                        {
                            label: vm.team.name,
                            data: vm.team.score
                        }
                    ]
                };


                var options = {
                    scale: {
                        ticks: {
                            min: 0,
                            max: 25
                        }
                    },

                    //Boolean - Whether to show lines for each scale point
                    scaleShowLine: true,

                    //Boolean - Whether we show the angle lines out of the radar
                    angleShowLineOut: true,

                    //Boolean - Whether to show labels on the scale
                    scaleShowLabels: false,

                    // Boolean - Whether the scale should begin at zero
                    scaleBeginAtZero: true,

                    //String - Colour of the angle line
                    angleLineColor: "rgba(0,0,0,.1)",

                    //Number - Pixel width of the angle line
                    angleLineWidth: 1,

                    //String - Point label font declaration
                    pointLabelFontFamily: "'Arial'",

                    //String - Point label font weight
                    pointLabelFontStyle: "normal",

                    //Number - Point label font size in pixels
                    pointLabelFontSize: 10,

                    //String - Point label font colour
                    pointLabelFontColor: "#376658",

                    //Boolean - Whether to show a dot for each point
                    pointDot: true,

                    //Number - Radius of each point dot in pixels
                    pointDotRadius: 3,

                    //Number - Pixel width of point dot stroke
                    pointDotStrokeWidth: 1,

                    //Number - amount extra to add to the radius to cater for hit detection outside the drawn point
                    pointHitDetectionRadius: 20,

                    //Boolean - Whether to show a stroke for datasets
                    datasetStroke: true,

                    //Number - Pixel width of dataset stroke
                    datasetStrokeWidth: 2,

                    //Boolean - Whether to fill the dataset with a colour
                    datasetFill: true,

                    scaleStartValue: 0,

                    //String - A legend template
                    legendTemplate: "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span style=\"background-color:<%=datasets[i].strokeColor%>\"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>"

                };


                // Get the context of the canvas element we want to select
                var ctx = document.getElementById("myChart").getContext("2d");
                var myRadarChart = new Chart(ctx, {
                    type: 'radar',
                    data: data,
                    options: options
                });

            }
        }
    });

    $(function () {


        first_get_data();

    });

    function first_get_data() {
    $.get("http://localhost:8887/get_data",

        function (res_data) {
            console.log(res_data.staff_data)
            vm.staff_data = res_data.staff_data;
            vm.table1_head = res_data.table1_head;
            vm.table2_head = res_data.table2_head;
            vm.team.score = res_data.avg_score;
        });
    }




</script>
</body>
</html>